<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html>
<html>
<head>
<link rel="canonical" href="https://www.tripadvisor.com/Hotels" />
<link rel="alternate" hrefLang="en"
	href="https://www.tripadvisor.com/Hotels" />
<link rel="alternate" hrefLang="en-GB"
	href="https://www.tripadvisor.co.uk/Hotels" />
<link rel="alternate" hrefLang="en-CA"
	href="https://www.tripadvisor.ca/Hotels" />
<link rel="alternate" hrefLang="fr-CA"
	href="https://fr.tripadvisor.ca/Hotels" />
<link rel="alternate" hrefLang="it"
	href="https://www.tripadvisor.it/Hotels" />
<link rel="alternate" hrefLang="es"
	href="https://www.tripadvisor.es/Hotels" />
<link rel="alternate" hrefLang="de"
	href="https://www.tripadvisor.de/Hotels" />
<link rel="alternate" hrefLang="fr"
	href="https://www.tripadvisor.fr/Hotels" />
<link rel="alternate" hrefLang="ja"
	href="https://www.tripadvisor.jp/Hotels" />
<link rel="alternate" hrefLang="zh-Hans"
	href="https://cn.tripadvisor.com/Hotels" />
<link rel="alternate" hrefLang="en-IN"
	href="https://www.tripadvisor.in/Hotels" />
<link rel="alternate" hrefLang="sv"
	href="https://www.tripadvisor.se/Hotels" />
<link rel="alternate" hrefLang="nl"
	href="https://www.tripadvisor.nl/Hotels" />
<link rel="alternate" hrefLang="pt"
	href="https://www.tripadvisor.com.br/Hotels" />
<link rel="alternate" hrefLang="tr"
	href="https://www.tripadvisor.com.tr/Hotels" />
<link rel="alternate" hrefLang="da"
	href="https://www.tripadvisor.dk/Hotels" />
<link rel="alternate" hrefLang="es-MX"
	href="https://www.tripadvisor.com.mx/Hotels" />
<link rel="alternate" hrefLang="en-IE"
	href="https://www.tripadvisor.ie/Hotels" />
<link rel="alternate" hrefLang="ar"
	href="https://ar.tripadvisor.com/Hotels" />
<link rel="alternate" hrefLang="ar-EG"
	href="https://www.tripadvisor.com.eg/Hotels" />
<link rel="alternate" hrefLang="de-AT"
	href="https://www.tripadvisor.at/Hotels" />
<link rel="alternate" hrefLang="el"
	href="https://www.tripadvisor.com.gr/Hotels" />
<link rel="alternate" hrefLang="en-AU"
	href="https://www.tripadvisor.com.au/Hotels" />
<link rel="alternate" hrefLang="en-MY"
	href="https://www.tripadvisor.com.my/Hotels" />
<link rel="alternate" hrefLang="en-NZ"
	href="https://www.tripadvisor.co.nz/Hotels" />
<link rel="alternate" hrefLang="en-PH"
	href="https://www.tripadvisor.com.ph/Hotels" />
<link rel="alternate" hrefLang="en-SG"
	href="https://www.tripadvisor.com.sg/Hotels" />
<link rel="alternate" hrefLang="en-ZA"
	href="https://www.tripadvisor.co.za/Hotels" />
<link rel="alternate" hrefLang="es-AR"
	href="https://www.tripadvisor.com.ar/Hotels" />
<link rel="alternate" hrefLang="es-CL"
	href="https://www.tripadvisor.cl/Hotels" />
<link rel="alternate" hrefLang="es-CO"
	href="https://www.tripadvisor.co/Hotels" />
<link rel="alternate" hrefLang="es-PE"
	href="https://www.tripadvisor.com.pe/Hotels" />
<link rel="alternate" hrefLang="es-VE"
	href="https://www.tripadvisor.com.ve/Hotels" />
<link rel="alternate" hrefLang="id"
	href="https://www.tripadvisor.co.id/Hotels" />
<link rel="alternate" hrefLang="he"
	href="https://www.tripadvisor.co.il/Hotels" />
<link rel="alternate" hrefLang="ko"
	href="https://www.tripadvisor.co.kr/Hotels" />
<link rel="alternate" hrefLang="nb"
	href="https://no.tripadvisor.com/Hotels" />
<link rel="alternate" hrefLang="pt-PT"
	href="https://www.tripadvisor.pt/Hotels" />
<link rel="alternate" hrefLang="ru"
	href="https://www.tripadvisor.ru/Hotels" />
<link rel="alternate" hrefLang="th"
	href="https://th.tripadvisor.com/Hotels" />
<link rel="alternate" hrefLang="vi"
	href="https://www.tripadvisor.com.vn/Hotels" />
<link rel="alternate" hrefLang="zh-Hant"
	href="https://www.tripadvisor.com.tw/Hotels" />
<link rel="alternate" hrefLang="de-CH"
	href="https://www.tripadvisor.ch/Hotels" />
<link rel="alternate" hrefLang="fr-CH"
	href="https://fr.tripadvisor.ch/Hotels" />
<link rel="alternate" hrefLang="it-CH"
	href="https://it.tripadvisor.ch/Hotels" />
<link rel="alternate" hrefLang="en-HK"
	href="https://en.tripadvisor.com.hk/Hotels" />
<link rel="alternate" hrefLang="fr-BE"
	href="https://fr.tripadvisor.be/Hotels" />
<link rel="alternate" hrefLang="nl-BE"
	href="https://www.tripadvisor.be/Hotels" />
<link rel="alternate" hrefLang="zh-hk"
	href="https://www.tripadvisor.com.hk/Hotels" />
<link rel="stylesheet"
	href="https://static.tacdn.com/assets/xztejajnpzxg-c.css"
	crossorigin="" />
<link rel="stylesheet"
	href="https://static.tacdn.com/assets/cjerkd.PPGnhl3.css"
	crossorigin="" />
<link rel="stylesheet"
	href="https://static.tacdn.com/assets/p7jq7m.4Ujcuf7.css"
	crossorigin="" />
<meta charset="UTF-8">
<title>Survey List</title>

<link rel="stylesheet" type="text/css" href="styles.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<style>
/* General styles */
body {
	font-family: Arial, sans-serif;
	background-color: #f4f4f4;
	margin: 0;
	padding: 0;
}

/* Main title */
h1 {
	color: black;
	text-align: center;
	margin-top: 20px;
}

/* Survey list container */
#surveyList {
	max-width: 800px;
	margin: 20px auto;
	padding: 10px;
}

/* Individual survey item */
.surveyItem {
	background-color: white;
	border: 2px solid #00aa6c;
	border-radius: 8px;
	padding: 15px;
	margin-bottom: 10px;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Survey title */
.surveyItem h2 {
	margin: 0 0 10px 0;
	color: black;
}

.viewSurvey:hover{
	background-color: #2cb386;
}
.deleteSurvey:hover{
	background-color: #2cb386;
}
.suggestSurvey:hover{
	background-color: #2cb386;
}


/* Buttons */
button {
	background-color: #00aa6c;
	color: white;
	border: none;
	padding: 10px 15px;
	border-radius: 5px;
	cursor: pointer;
	margin-right: 10px;
	margin-top: 15px;
}


.Za {
	z-index: 0;
}

.form {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
    background-color: #ffffff;
    border: 2px solid #00aa6c;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    max-width: 500px;
    margin: 20px auto;
}


/* Modal styles */
.modal {
	display: none;
	position: fixed;
	z-index: 1;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	overflow: auto;
	background-color: rgba(0, 0, 0, 0.5);
	z-index: 5;
}


#surveyDetailContent{
     max-width: 600px;
    margin: 0 auto;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 10px;
    background-color: #f9f9f9;
}

#surveyDetailContent label{
 	display: block;
}


#surveyDetailContent input[type="text"], #surveyDetailContent select {
	width: 100%;
	padding: 10px;
	margin: 5px 0 20px;
	border: 1px solid #ccc;
	border-radius: 5px;
	box-sizing: border-box; /* 모든 박스 요소의 너비와 높이를 포함한 패딩과 테두리를 계산 */
}


#surveyDetailContent input[type="submit"]:hover {
	background-color: #45a049;
}
#surveyDetailContent {
	max-width: 600px;
	margin: 0 auto;
	padding: 20px;
	border: 1px solid #ccc;
	border-radius: 10px;
	background-color: #f9f9f9;
}

/* Close button */
.close {
	color: #aaaaaa;
	float: right;
	font-size: 28px;
	font-weight: bold;
}

.close:hover, .close:focus {
	color: #000;
	text-decoration: none;
	cursor: pointer;
}

<!--
==============================================
--> /* Modal styles */
.modal {
	display: none;
	position: fixed;
	z-index: 1;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	overflow: auto;
	background-color: rgba(0, 0, 0, 0.4);
	margin-top: 20%;
}

.modal-content {
	background-color: #fff;
    margin: 7% auto;
    padding: 20px;
    border: 2px solid #6f6f6f;
    border-radius: 8px;
    width: 80%;
    max-width: 600px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.close {
	color: #aaa;
	float: right;
	font-size: 28px;
	font-weight: bold;
}

.close:hover, .close:focus {
	color: #34e0a1;
	text-decoration: none;
	cursor: pointer;
}

iframe {
	width: 100%;
	height: 100%;
	border: none;
}
</style>
</head>
<body>
<%@ include file="/resources/includes/header.jsp" %> 
		<main>
			<h1>Survey List</h1>
			<div id="surveyList">
				<c:forEach var="survey" items="${surveys}">
					<div class="surveyItem" data-survey-id="${survey.survey_no}">
						<h2 class="HeaderSurvey">${survey.country}- ${survey.area}</h2>
						<p>시작 날짜: ${survey.start_date}, 종료 날짜: ${survey.end_date}</p>
						<button class="viewSurvey">보기</button>
						<button class="deleteSurvey">삭제</button>
						<button class="suggestSurvey">여행지추천</button>
					</div>
				</c:forEach>
			</div>

			<div id="surveyModal" class="modal">
				<div class="modal-content">
					<span class="close" id="closeModal">&times;</span>
					<div id="surveyDetailContent"></div>
				</div>
			</div>
		</main>
		
		 <script>
			$(document)
					.ready(
							function() {
								$('.viewSurvey')
										.click(
												function() {
													var surveyId = $(this)
															.closest(
																	'.surveyItem')
															.data('survey-id');
													$
															.ajax({
																url : 'surveysearch.do',
																type : 'GET',
																data : {
																	survey_no : surveyId
																},
																success : function(
																		data) {
																	$(
																			'#surveyDetailContent')
																			.html(
																					data);
																	$(
																			'#surveyModal')
																			.show();
																},
																error : function(
																		xhr,
																		status,
																		error) {
																	alert('설문을 불러오는 데 실패했습니다.');
																}
															});
												});

								$('#closeModal').click(function() {
									$('#surveyModal').hide();
									$('#surveyDetailContent').html('');
								});

								$(window).click(function(event) {
									if (event.target.id === 'surveyModal') {
										$('#surveyModal').hide();
										$('#surveyDetailContent').html('');
									}
								});

								$('.deleteSurvey')
										.click(
												function() {
													var surveyId = $(this)
															.closest(
																	'.surveyItem')
															.data('survey-id');
													if (confirm('해당 설문을 삭제하시겠습니까?')) {
														$
																.ajax({
																	url : 'deleteSurvey.do',
																	type : 'POST',
																	data : {
																		survey_no : surveyId
																	},
																	success : function(
																			response) {
																		alert('설문이 삭제되었습니다.');
																		location
																				.reload();
																	},
																	error : function(
																			xhr,
																			status,
																			error) {
																		alert('설문 삭제에 실패했습니다.');
																	}
																});
													}
												});
							});
		</script>
</body>
</html>
